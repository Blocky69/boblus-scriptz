local light = game.Workspace.MLight.SpotLight
local lastDisabledTime = nil
local receivedMorse = ""
local decodedNumbers = {}
local signalCount = 0
local numberCount = 0

local morseNumbers = {
    ["-----"] = "0", [".----"] = "1", ["..---"] = "2", ["...--"] = "3",
    ["....-"] = "4", ["....."] = "5", ["-...."] = "6", ["--..."] = "7",
    ["---.."] = "8", ["----."] = "9"
}

local function decodeMorse(morse)
    return morseNumbers[morse] or "?"
end

local function monitorLight()
    while true do
        if light.Enabled then
            lastDisabledTime = nil
            local startTime = os.clock()

            while light.Enabled do task.wait() end
            local duration = os.clock() - startTime

            if duration >= 0.8 then
                receivedMorse = receivedMorse .. "-"
            else
                receivedMorse = receivedMorse .. "."
            end

            signalCount = signalCount + 1

            if signalCount >= 5 then
                local decoded = decodeMorse(receivedMorse)
                table.insert(decodedNumbers, decoded)
                receivedMorse = ""
                signalCount = 0
                numberCount = numberCount + 1

                if numberCount >= 6 then
                    task.wait(3)
                    print("Decoded 6-digit Number:", table.concat(decodedNumbers))
                    decodedNumbers = {}
                    numberCount = 0
                end
            end
        else
            if lastDisabledTime == nil then
                lastDisabledTime = os.clock()
            elseif os.clock() - lastDisabledTime >= 3 then
                receivedMorse = ""
                decodedNumbers = {}
                numberCount = 0
                signalCount = 0
            end
        end

        task.wait(0.1)
    end
end

task.spawn(monitorLight)
print("Script Loaded! Please be patient. -- Morse Code Room 5")
