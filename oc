local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Player = game.Players.LocalPlayer.DisplayName
local User = game.Players.LocalPlayer.Name
pn = None
pv = 0
en = None
ev = 0

local function Notify(T, C, D, I)
    Rayfield:Notify({
       Title = T or "Notification Title",
       Content = C or "Notification Content",
       Duration = D or 0,
       Image = I or 4483362458,
    })
end

local Window = Rayfield:CreateWindow({
   Name = "Obby Creator",
   Icon = 0,
   LoadingTitle = "Loading",
   LoadingSubtitle = "0-o",
   Theme = "Default",

   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false,

   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "OC"
   },

   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },

   KeySystem = false,
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided",
      FileName = "Key",
      SaveKey = true,
      GrabKeyFromSite = false,
      Key = {"amgis"}
   }
})

local H = Window:CreateTab("Home", 4483362458)
H:CreateLabel("Welcome! " .. Player .. " (" .. User .. ") Thank you for using my script! :)", 4483362458, Color3.fromRGB(255, 255, 255), false)
H:CreateParagraph({Title = "This script is open-source", Content = "Feel free to improve or take parts of the code, Credits are appreciated!"})
H:CreateParagraph({Title = "Contact me!", Content = "DM @velocity_coding on discord to report a bugs or suggestions."})

H:CreateButton({
    Name = "Remove UI",
    Callback = function()
        Notify("Notification!", "Removing UI :(", 3, 4483362458)
        wait(3.5)
        Rayfield:Destroy()
    end,
})

H:CreateButton({
    Name = "Join Discord Server",
    Callback = function()
        Notify("Notification!", "Copied Discord Server Link!", 3, 4483362458)
        setclipboard("https://discord.gg/y2jW3MUxdx")
    end,
})

local M = Window:CreateTab("Main (Visual)", 4483345998)

local playerNames = {}
for _, player in ipairs(game.Players:GetPlayers()) do
    table.insert(playerNames, player.Name)
end

local obby

M:CreateDropdown({
   Name = "Select User Obby",
   Options = playerNames,
   CurrentOption = {"None"},
   MultipleOptions = false,
   Flag = "Dropdown1",
   Callback = function(Selected)
       plrname = Selected
       obby = workspace.Obbies:FindFirstChild(plrname)
       if obby then
           Notify("Notification!", "Selected " .. plrname .. "'s obby!", 3, 4483362458)
       else
           Notify("Warning!", "Obby not found for " .. plrname .. "!", 3, 4483362458)
       end
   end,
})

M:CreateDropdown({
   Name = "Skybox Changer (Visual)",
   Options = {"Alien Sunset","Approaching Neptune","Black","Blue Skies","Dark Night","Deep Blue Sky","Deep Space Purple","Default","Dreamy Ocean","Dusty Clouds","Green","Light Night Sky","Mountain Night","Mountain","Open Ocean","Orange Sky","Orbital Scenery","Purple Nebula","Rainy Day","Retro","Rocky Volcanoes","Setting Sun","Stormy Days","The Sky","White"},
   CurrentOption = {"Default"},
   MultipleOptions = false,
   Flag = "Dropdown2",
   Callback = function(Options)
       obby.Skybox.Value = Options
   end,
})

M:CreateInput({
   Name = "Jump Limit (FE) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "0 is inf (only you can use it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input1",
   Callback = function(Text)
       obby.JumpLimit.Value = Text
   end,
})

M:CreateInput({
   Name = "Music ID (Visual)",
   CurrentValue = "",
   PlaceholderText = "Music ID here",
   RemoveTextAfterFocusLost = false,
   Flag = "Input2",
   Callback = function(Text)
       obby.MusicId.Value = Text
   end,
})

M:CreateInput({
   Name = "Walkspeed (FE) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "0 is unwalkable (only you can use it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input3",
   Callback = function(Text)
       obby.Avatar.Walk.Value = Text
   end,
})

M:CreateInput({
   Name = "Jump Power (FE) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "0 is unjumpable (only you can use it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input4",
   Callback = function(Text)
       obby.Avatar.Jump.Value = Text
   end,
})

M:CreateInput({
   Name = "Gravity (FE) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "0 is floating (only you can use it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input5",
   Callback = function(Text)
       obby.GravityVal.Value = Text
   end,
})

M:CreateInput({
   Name = "Minimum Zoom (Visual) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "(only you can use it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input6",
   Callback = function(Text)
       obby.Camera.MinZoom.Value = Text
   end,
})

M:CreateInput({
   Name = "Maximum Zoom (Visual) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "(only you can use it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input7",
   Callback = function(Text)
       obby.Camera.MaxZoom.Value = Text
   end,
})

M:CreateInput({
   Name = "Change Obby ID (Visual) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "(only you can see it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input8",
   Callback = function(Text)
       obby.IdVAL.Value = Text
       obby.GetObby.NamePlate.Star.IdGui.TextLabel.Text = "ObbyID: " .. Text""
   end,
})

M:CreateInput({
   Name = "Change Creator of Obby Name (Visual) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "(only you can see it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input9",
   Callback = function(Text)
       obby.OwnerNameVAL.Value = Text
       obby.GetObby.NamePlate.Main.SurfaceGui.TextLabel.Text = Text
   end,
})

M:CreateInput({
   Name = "Change Obby Name (Visual) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "(only you can see it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input10",
   Callback = function(Text)
       obby.ObbyNameVAL.Value = Text
       obby.GetObby.Ratings.NameBit.SurfaceGui.TextLabel.Text = Text
   end,
})

M:CreateInput({
   Name = "Spoof Like Count (Visual) [Only work on selected obby]",
   CurrentValue = "",
   PlaceholderText = "(only you can see it)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input11",
   Callback = function(Text)
       obby.GetObby.Ratings.Likes.SurfaceGui.TextLabel.Text = Text
   end,
})

M:CreateToggle({
   Name = "Give Fly Tool [Only work on selected obby]",
   CurrentValue = false,
   Flag = "Toggle1",
   Callback = function(Val)
       obby.Options.Fly.Value = Val
   end,
})

M:CreateButton({
   Name = "Give Teleport Tools",
   Callback = function()
       mouse = game.Players.LocalPlayer:GetMouse()
       tool = Instance.new("Tool")
       tool.RequiresHandle = false
       tool.Name = "Teleport Tool"
       tool.Activated:connect(function()
           local pos = mouse.Hit+Vector3.new(0,2.5,0)
           pos = CFrame.new(pos.X,pos.Y,pos.Z)
           game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = pos
       end)
       tool.Parent = game.Players.LocalPlayer.Backpack
   end,
})

M:CreateToggle({
    Name = "Make Selected Obby Area Bigger (Cannot place out of bounds)",
    CurrentValue = false,
    Flag = "Toggle2",
    Callback = function(Val)
        if obby and obby:FindFirstChild("Area") and obby.Area:FindFirstChild("Area") then
            local areaPart = obby.Area.Area

            if areaPart:IsA("BasePart") then
                if Val then
                    areaPart.Size = Vector3.new(2048, 2048, 2048)
                    Notify("Notification!", "This function is great for flying or spectating in your obby!", 5, 4483362458)
                else
                    areaPart.Size = Vector3.new(180.1, 200.1, 500.1)
                    Notify("Notification!", "Function disabled!", 5, 4483362458)
                end
            else
                Notify("Warning!", "Obby area is not a valid Part!", 5, 4483362458)
            end
        else
            Notify("Warning!", "Obby area not found!", 5, 4483362458)
        end
    end,
})

local O = Window:CreateTab("Obby", 4483362458)
local selectedPartPath = nil
local highlight = nil
local selecting = false

local function getPath(instance)
    local path = instance.Name
    while instance.Parent and instance.Parent ~= game do
        instance = instance.Parent
        path = instance.Name .. "." .. path
    end
    return path
end

local function highlightPart(part)
    if highlight then highlight:Destroy() end -- Remove old highlight
    highlight = Instance.new("SelectionBox")
    highlight.Adornee = part
    highlight.LineThickness = 0.05
    highlight.Color3 = Color3.fromRGB(255, 0, 0)
    highlight.Parent = part
end

local function onPartClicked(part)
    if selecting and obby and part:IsDescendantOf(obby) then
        selectedPartPath = getPath(part)
        highlightPart(part)
        Notify("Notification!", "Selected part: " .. selectedPartPath, 3, 4483362458)
    end
end

local function enablePartSelection(enabled)
    selecting = enabled
    if not enabled and highlight then
        highlight:Destroy()
        highlight = nil
    end
end

O:CreateToggle({
    Name = "Select Part (Click on a part in the obby)",
    CurrentValue = false,
    Flag = "ToggleSelectPart",
    Callback = function(Val)
        enablePartSelection(Val)
        if Val then
            Notify("Notification!", "Click on a part in the selected obby!", 3, 4483362458)
        else
            Notify("Notification!", "Part selection disabled!", 3, 4483362458)
        end
    end,
})

O:CreateInput({
   Name = "Properties",
   CurrentValue = "",
   PlaceholderText = "Properties Name",
   RemoveTextAfterFocusLost = false,
   Flag = "Input12",
   Callback = function(Text)
       pn = Text
   end,
})

O:CreateInput({
   Name = "Properties Value",
   CurrentValue = "",
   PlaceholderText = "number/true or false",
   RemoveTextAfterFocusLost = false,
   Flag = "Input13",
   Callback = function(Text)
       pv = Text
   end,
})

O:CreateInput({
   Name = "Effects",
   CurrentValue = "",
   PlaceholderText = "Effect Name",
   RemoveTextAfterFocusLost = false,
   Flag = "Input14",
   Callback = function(Text)
       en = Text
   end,
})

O:CreateInput({
   Name = "Effects Value",
   CurrentValue = "",
   PlaceholderText = "number/true or false",
   RemoveTextAfterFocusLost = false,
   Flag = "Input15",
   Callback = function(Text)
       ev = Text
   end,
})

game:GetService("UserInputService").InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if selecting and input.UserInputType == Enum.UserInputType.MouseButton1 then
        local mouse = game.Players.LocalPlayer:GetMouse()
        local target = mouse.Target
        if target then
            onPartClicked(target)
        end
    end
end)

local Remote = game.ReplicatedStorage.Events:FindFirstChild("PaintObject")
local function changePartProperty(property, value)
    if selectedPartPath then
        Remote:FireServer(selectedPartPath, property, value)
        Notify("Notification!", "Changed " .. property .. " to " .. tostring(value), 3, 4483362458)
    else
        Notify("Warning!", "No part selected!", 3, 4483362458)
    end
end

local Remote1 = game.ReplicatedStorage.Events:FindFirstChild("EffectObject")
local function changePartEffects(property, value)
    if selectedPartPath then
        Remote1:FireServer(selectedPartPath, property, value)
        Notify("Notification!", "Changed " .. property .. " to " .. tostring(value), 3, 4483362458)
    else
        Notify("Warning!", "No part selected!", 3, 4483362458)
    end
end

local function changePartSize(newSize)
    if selectedPartPath and obby and obby:FindFirstChild("Area") then
        local area = obby.Area
        local scaledSize = Vector3.new(
            area.Size.X * newSize.X,
            area.Size.Y * newSize.Y,
            area.Size.Z * newSize.Z
        )

        Remote:FireServer(selectedPartPath, "Size", scaledSize)
        Notify("Notification!", "Changed size to: " .. tostring(scaledSize), 3, 4483362458)
    else
        Notify("Warning!", "No part selected or Obby area not found!", 3, 4483362458)
    end
end

local function changePartPosition(newPos)
    if selectedPartPath and obby and obby:FindFirstChild("Area") then
        local area = obby.Area
        local relativePos = Vector3.new(
            area.Position.X + newPos.X * area.Size.X,
            area.Position.Y + newPos.Y * area.Size.Y,
            area.Position.Z + newPos.Z * area.Size.Z
        )

        Remote:FireServer(selectedPartPath, "Position", relativePos)
        Notify("Notification!", "Changed position to: " .. tostring(relativePos), 3, 4483362458)
    else
        Notify("Warning!", "No part selected or Obby area not found!", 3, 4483362458)
    end
end

O:CreateInput({
   Name = "Size (Relative to Area)",
   CurrentValue = "",
   PlaceholderText = "X, Y, Z (e.g., 0.5, 0.5, 0.5)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input16",
   Callback = function(Text)
       local values = {}
       for num in Text:gmatch("[^,]+") do
           table.insert(values, tonumber(num))
       end
       if #values == 3 then
           changePartSize(Vector3.new(values[1], values[2], values[3]))
       else
           Notify("Warning!", "Invalid format! Use: X, Y, Z", 3, 4483362458)
       end
   end,
})

O:CreateInput({
   Name = "Position (Relative to Area)",
   CurrentValue = "",
   PlaceholderText = "X, Y, Z (e.g., 0.5, 0.5, 0.5)",
   RemoveTextAfterFocusLost = false,
   Flag = "Input17",
   Callback = function(Text)
       local values = {}
       for num in Text:gmatch("[^,]+") do
           table.insert(values, tonumber(num))
       end
       if #values == 3 then
           changePartPosition(Vector3.new(values[1], values[2], values[3]))
       else
           Notify("Warning!", "Invalid format! Use: X, Y, Z", 3, 4483362458)
       end
   end,
})

Notify("Notification!", "Script Loaded!", 5, 4483362458)
